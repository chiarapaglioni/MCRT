cd /data/transient/cxp431/Documents/MCRT ; /usr/bin/env /data/transient/cxp431/miniconda3/envs/mcrt/bin/python /data/transient/cxp431/.vscode/extensions/ms-python.debugpy-2025.10.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher 42173 -- /data/transient/cxp431/Documents/MCRT/launch.py train --config config/train_cpu.yml 
GPU not found, code will run on CPU and can be extremely slow!
2025-07-22 15:43:53,663 - INFO - MCRT DENOISING :)
2025-07-22 15:43:53,678 - INFO - Using device: cpu
2025-07-22 15:44:01,670 - INFO - DATASET mean [-1.1037, -1.2116, -1.3008] - std [2.0117, 1.8141, 1.642]
2025-07-22 15:44:01,670 - INFO - Self-Supervised (noise2noise) mode
2025-07-22 15:44:01,671 - INFO - 14 scenes: ['bathroom2_scene', 'bathroom_scene', 'bedroom_scene', 'classroom_scene', 'dining-room_scene', 'house_scene', 'house_scene-above', 'kitchen_scene', 'living-room-2_scene', 'living-room-3_scene', 'living-room_scene', 'staircase2_scene', 'staircase_scene', 'veach-ajar_scene']
2025-07-22 15:44:08,886 - INFO - Total dataset size: 700
2025-07-22 15:44:08,887 - INFO - Training set size:  560
2025-07-22 15:44:08,887 - INFO - Validation set size: 140
2025-07-22 15:44:12,746 - INFO - Input shape:  torch.Size([32, 3, 128, 128])
2025-07-22 15:44:12,747 - INFO - Target shape: torch.Size([32, 3, 128, 128])
2025-07-22 15:44:12,747 - INFO - Noisy shape:  torch.Size([32, 3, 128, 128])
2025-07-22 15:44:12,747 - INFO - Clean shape:  torch.Size([32, 3, 128, 128])
2025-07-22 15:44:12,750 - INFO - 
Dataset Config: IMG mode | Crop Size: 128 | Augmentation: True
2025-07-22 15:44:12,750 - INFO - Model Config: Depth=4 | Start Filters=32 | Output: mean
2025-07-22 15:44:12,750 - INFO - Training for 30 epochs | Batch Size: 32 | Val Split: 0.2 | Learning Rate: 1e-4

2025-07-22 15:44:12,784 - INFO - Using Tonemap: REINHARD
2025-07-22 15:44:12,784 - INFO - Using Loss: MSE
2025-07-22 15:44:12,785 - INFO - TRAINING STARTED !
2025-07-22 15:45:31,589 - INFO - [Epoch 1/30] Train Loss: 0.1051 | Val Loss: 0.0839 | Val PSNR: 16.55 dB | Time: 78.80s
2025-07-22 15:45:31,611 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:46:48,333 - INFO - [Epoch 2/30] Train Loss: 0.0828 | Val Loss: 0.0783 | Val PSNR: 16.99 dB | Time: 76.72s
2025-07-22 15:46:48,355 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:48:04,871 - INFO - [Epoch 3/30] Train Loss: 0.0758 | Val Loss: 0.0707 | Val PSNR: 17.51 dB | Time: 76.52s
2025-07-22 15:48:04,893 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:49:26,030 - INFO - [Epoch 4/30] Train Loss: 0.0722 | Val Loss: 0.0703 | Val PSNR: 17.70 dB | Time: 81.14s
2025-07-22 15:49:26,053 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:50:42,637 - INFO - [Epoch 5/30] Train Loss: 0.0683 | Val Loss: 0.0649 | Val PSNR: 18.25 dB | Time: 76.58s
2025-07-22 15:50:42,659 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:51:59,514 - INFO - [Epoch 6/30] Train Loss: 0.0687 | Val Loss: 0.0661 | Val PSNR: 18.06 dB | Time: 76.85s
2025-07-22 15:53:15,921 - INFO - [Epoch 7/30] Train Loss: 0.0681 | Val Loss: 0.0657 | Val PSNR: 17.75 dB | Time: 76.41s
2025-07-22 15:54:34,796 - INFO - [Epoch 8/30] Train Loss: 0.0654 | Val Loss: 0.0648 | Val PSNR: 18.13 dB | Time: 78.87s
2025-07-22 15:54:34,819 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:55:51,228 - INFO - [Epoch 9/30] Train Loss: 0.0672 | Val Loss: 0.0620 | Val PSNR: 18.37 dB | Time: 76.41s
2025-07-22 15:55:51,250 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 15:57:07,815 - INFO - [Epoch 10/30] Train Loss: 0.0632 | Val Loss: 0.0629 | Val PSNR: 19.38 dB | Time: 76.56s
2025-07-22 15:59:05,588 - INFO - [Epoch 11/30] Train Loss: 0.0627 | Val Loss: 0.0608 | Val PSNR: 17.71 dB | Time: 117.77s
2025-07-22 15:59:05,611 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:00:24,522 - INFO - [Epoch 12/30] Train Loss: 0.0612 | Val Loss: 0.0554 | Val PSNR: 18.96 dB | Time: 78.91s
2025-07-22 16:00:24,546 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:01:42,373 - INFO - [Epoch 13/30] Train Loss: 0.0610 | Val Loss: 0.0712 | Val PSNR: 16.94 dB | Time: 77.83s
2025-07-22 16:02:59,767 - INFO - [Epoch 14/30] Train Loss: 0.0625 | Val Loss: 0.0580 | Val PSNR: 20.09 dB | Time: 77.39s
2025-07-22 16:04:17,916 - INFO - [Epoch 15/30] Train Loss: 0.0616 | Val Loss: 0.0596 | Val PSNR: 18.84 dB | Time: 78.15s
2025-07-22 16:05:37,135 - INFO - [Epoch 16/30] Train Loss: 0.0611 | Val Loss: 0.0553 | Val PSNR: 18.38 dB | Time: 79.22s
2025-07-22 16:05:37,158 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:06:53,801 - INFO - [Epoch 17/30] Train Loss: 0.0602 | Val Loss: 0.0554 | Val PSNR: 19.04 dB | Time: 76.64s
2025-07-22 16:08:11,802 - INFO - [Epoch 18/30] Train Loss: 0.0604 | Val Loss: 0.0537 | Val PSNR: 19.34 dB | Time: 78.00s
2025-07-22 16:08:11,825 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:09:29,738 - INFO - [Epoch 19/30] Train Loss: 0.0599 | Val Loss: 0.0609 | Val PSNR: 19.23 dB | Time: 77.91s
2025-07-22 16:10:47,043 - INFO - [Epoch 20/30] Train Loss: 0.0613 | Val Loss: 0.0526 | Val PSNR: 17.95 dB | Time: 77.30s
2025-07-22 16:10:47,065 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:12:04,531 - INFO - [Epoch 21/30] Train Loss: 0.0585 | Val Loss: 0.0543 | Val PSNR: 18.38 dB | Time: 77.47s
2025-07-22 16:13:23,368 - INFO - [Epoch 22/30] Train Loss: 0.0591 | Val Loss: 0.0574 | Val PSNR: 17.33 dB | Time: 78.84s
2025-07-22 16:14:43,420 - INFO - [Epoch 23/30] Train Loss: 0.0587 | Val Loss: 0.0585 | Val PSNR: 18.97 dB | Time: 80.05s
2025-07-22 16:16:02,536 - INFO - [Epoch 24/30] Train Loss: 0.0568 | Val Loss: 0.0547 | Val PSNR: 18.13 dB | Time: 79.12s
2025-07-22 16:17:28,841 - INFO - [Epoch 25/30] Train Loss: 0.0603 | Val Loss: 0.0552 | Val PSNR: 18.75 dB | Time: 86.30s
2025-07-22 16:18:47,783 - INFO - [Epoch 26/30] Train Loss: 0.0590 | Val Loss: 0.0499 | Val PSNR: 19.50 dB | Time: 78.94s
2025-07-22 16:18:47,806 - INFO - Saved best model to checkpoints/2025-07-22_noise2noise_mean_binsimg.pth
2025-07-22 16:20:06,498 - INFO - [Epoch 27/30] Train Loss: 0.0573 | Val Loss: 0.0545 | Val PSNR: 17.37 dB | Time: 78.69s
2025-07-22 16:21:29,629 - INFO - [Epoch 28/30] Train Loss: 0.0579 | Val Loss: 0.0538 | Val PSNR: 18.42 dB | Time: 83.13s
2025-07-22 16:22:57,216 - INFO - [Epoch 29/30] Train Loss: 0.0563 | Val Loss: 0.0536 | Val PSNR: 11.61 dB | Time: 87.59s
2025-07-22 16:24:14,524 - INFO - [Epoch 30/30] Train Loss: 0.0565 | Val Loss: 0.0504 | Val PSNR: 19.54 dB | Time: 77.31s
2025-07-22 16:24:14,740 - INFO - Loss plot saved to plots/2025-07-22_img_loss_plot.png
2025-07-22 16:24:14,929 - INFO - Saved PSNR plot to plots/2025-07-22_img_psnr_plot.png
(mcrt) (base) cxp431@cca-ug04-030:~/Documents/MCRT$ 