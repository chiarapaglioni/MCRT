2025-07-17 18:24:25,940 - INFO - MCRT DENOISING :)
2025-07-17 18:24:27,748 - INFO - Using device: cuda
2025-07-17 18:24:27,749 - INFO - 27 scenes: ['banner_01_scene', 'banner_02_scene', 'bathroom2_scene', 'bathroom_scene', 'bedroom_scene', 'classroom_scene', 'cornell-box_scene', 'dining-room_scene', 'glass-of-water_scene', 'house_scene', 'house_scene-above', 'kitchen_scene', 'lamp_scene', 'lamp_scene-above', 'living-room-2_scene', 'living-room-3_scene', 'living-room_scene', 'matpreview_scene', 'matpreview_scene-above', 'spaceship_scene', 'staircase2_scene', 'staircase_scene', 'teapot-full_scene', 'veach-ajar_scene', 'veach-bidir_scene', 'veach-mis_scene', 'volumetric-caustic_scene']
2025-07-17 18:24:27,922 - INFO - Generating Histogram: banner_01_scene_spp32_bins16_hist.npz
2025-07-17 18:24:41,625 - INFO - Generating Histogram: banner_02_scene_spp32_bins16_hist.npz
2025-07-17 18:24:55,299 - INFO - Generating Histogram: bathroom_scene_spp32_bins16_hist.npz
2025-07-17 18:25:08,395 - INFO - Generating Histogram: bathroom2_scene_spp32_bins16_hist.npz
2025-07-17 18:25:21,503 - INFO - Generating Histogram: bedroom_scene_spp32_bins16_hist.npz
2025-07-17 18:25:34,491 - INFO - Generating Histogram: classroom_scene_spp32_bins16_hist.npz
2025-07-17 18:25:47,939 - INFO - Generating Histogram: cornell-box_scene_spp32_bins16_hist.npz
2025-07-17 18:26:01,782 - INFO - Generating Histogram: dining-room_scene_spp32_bins16_hist.npz
2025-07-17 18:26:14,893 - INFO - Generating Histogram: glass-of-water_scene_spp32_bins16_hist.npz
2025-07-17 18:26:28,785 - INFO - Generating Histogram: house_scene_spp32_bins16_hist.npz
2025-07-17 18:26:42,933 - INFO - Generating Histogram: house_scene-above_spp32_bins16_hist.npz
2025-07-17 18:26:57,013 - INFO - Generating Histogram: kitchen_scene_spp32_bins16_hist.npz
2025-07-17 18:27:10,184 - INFO - Generating Histogram: lamp_scene_spp32_bins16_hist.npz
2025-07-17 18:27:23,585 - INFO - Generating Histogram: lamp_scene-above_spp32_bins16_hist.npz
2025-07-17 18:27:37,064 - INFO - Generating Histogram: living-room_scene_spp32_bins16_hist.npz
2025-07-17 18:27:50,025 - INFO - Generating Histogram: living-room-2_scene_spp32_bins16_hist.npz
2025-07-17 18:28:03,155 - INFO - Generating Histogram: living-room-3_scene_spp32_bins16_hist.npz
2025-07-17 18:28:17,301 - INFO - Generating Histogram: matpreview_scene_spp32_bins16_hist.npz
2025-07-17 18:28:31,243 - INFO - Generating Histogram: matpreview_scene-above_spp32_bins16_hist.npz
2025-07-17 18:28:45,573 - INFO - Generating Histogram: spaceship_scene_spp32_bins16_hist.npz
2025-07-17 18:28:59,035 - INFO - Generating Histogram: staircase_scene_spp32_bins16_hist.npz
2025-07-17 18:29:12,825 - INFO - Generating Histogram: staircase2_scene_spp32_bins16_hist.npz
2025-07-17 18:29:26,929 - INFO - Generating Histogram: teapot-full_scene_spp32_bins16_hist.npz
2025-07-17 18:29:41,014 - INFO - Generating Histogram: veach-ajar_scene_spp32_bins16_hist.npz
2025-07-17 18:29:54,033 - INFO - Generating Histogram: veach-bidir_scene_spp32_bins16_hist.npz
2025-07-17 18:30:07,168 - INFO - Generating Histogram: veach-mis_scene_spp32_bins16_hist.npz
2025-07-17 18:30:20,145 - INFO - Generating Histogram: volumetric-caustic_scene_spp32_bins16_hist.npz
2025-07-17 18:30:34,112 - INFO - Train dataset size: 2700 samples
2025-07-17 18:30:34,112 - INFO - Val dataset size: 300 samples
2025-07-17 18:30:38,243 - INFO - Input shape: torch.Size([32, 3, 18, 192, 192])
2025-07-17 18:30:38,243 - INFO - Target shape: torch.Size([32, 3, 192, 192])
2025-07-17 18:30:38,244 - INFO - Noisy shape: torch.Size([32, 3, 192, 192])
2025-07-17 18:30:38,244 - INFO - Clean shape: torch.Size([32, 3, 192, 192])
2025-07-17 18:30:38,263 - INFO - 
Dataset Config: HIST mode | Crop Size: 192 | Augmentation: True
2025-07-17 18:30:38,263 - INFO - Model Config: Depth=5 | Start Filters=32 | Output: mean
2025-07-17 18:30:38,263 - INFO - Training for 30 epochs | Batch Size: 32 | Val Split: 0.1 | Learning Rate: 1e-4

2025-07-17 18:30:38,407 - INFO - TRAINING STARTED !
2025-07-17 18:31:03,566 - INFO - [Epoch 1/30] Train Loss: 1.1081 | Val Loss: 0.8222 | Time: 25.16s
2025-07-17 18:31:03,632 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:31:28,699 - INFO - [Epoch 2/30] Train Loss: 0.8515 | Val Loss: 0.8452 | Time: 25.07s
2025-07-17 18:31:53,957 - INFO - [Epoch 3/30] Train Loss: 0.8113 | Val Loss: 0.8198 | Time: 25.26s
2025-07-17 18:31:54,028 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:32:18,964 - INFO - [Epoch 4/30] Train Loss: 0.8119 | Val Loss: 0.8498 | Time: 24.94s
2025-07-17 18:32:43,782 - INFO - [Epoch 5/30] Train Loss: 0.7966 | Val Loss: 0.8528 | Time: 24.82s
2025-07-17 18:33:08,938 - INFO - [Epoch 6/30] Train Loss: 0.7633 | Val Loss: 0.8377 | Time: 25.16s
2025-07-17 18:33:34,170 - INFO - [Epoch 7/30] Train Loss: 0.7984 | Val Loss: 0.8527 | Time: 25.23s
2025-07-17 18:33:58,795 - INFO - [Epoch 8/30] Train Loss: 0.7755 | Val Loss: 0.7488 | Time: 24.63s
2025-07-17 18:33:58,865 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:34:23,579 - INFO - [Epoch 9/30] Train Loss: 0.7899 | Val Loss: 0.8360 | Time: 24.71s
2025-07-17 18:34:49,496 - INFO - [Epoch 10/30] Train Loss: 0.7792 | Val Loss: 0.8277 | Time: 25.92s
2025-07-17 18:35:14,211 - INFO - [Epoch 11/30] Train Loss: 0.7641 | Val Loss: 0.8077 | Time: 24.71s
2025-07-17 18:35:38,913 - INFO - [Epoch 12/30] Train Loss: 0.7608 | Val Loss: 0.7870 | Time: 24.70s
2025-07-17 18:36:03,667 - INFO - [Epoch 13/30] Train Loss: 0.7415 | Val Loss: 0.7987 | Time: 24.75s
2025-07-17 18:36:29,228 - INFO - [Epoch 14/30] Train Loss: 0.7540 | Val Loss: 0.7461 | Time: 25.56s
2025-07-17 18:36:29,298 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:36:54,950 - INFO - [Epoch 15/30] Train Loss: 0.7597 | Val Loss: 0.7440 | Time: 25.65s
2025-07-17 18:36:55,021 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:37:19,937 - INFO - [Epoch 16/30] Train Loss: 0.7736 | Val Loss: 0.7909 | Time: 24.92s
2025-07-17 18:37:44,843 - INFO - [Epoch 17/30] Train Loss: 0.7396 | Val Loss: 0.8598 | Time: 24.91s
2025-07-17 18:38:11,165 - INFO - [Epoch 18/30] Train Loss: 0.7534 | Val Loss: 0.6802 | Time: 26.32s
2025-07-17 18:38:11,236 - INFO - Saved best model to checkpoints/2025-07-17_hist2noise_mean_bins16.pth
2025-07-17 18:38:36,204 - INFO - [Epoch 19/30] Train Loss: 0.7117 | Val Loss: 0.8059 | Time: 24.97s
2025-07-17 18:39:01,231 - INFO - [Epoch 20/30] Train Loss: 0.7351 | Val Loss: 0.7703 | Time: 25.03s
2025-07-17 18:39:26,191 - INFO - [Epoch 21/30] Train Loss: 0.7346 | Val Loss: 0.7356 | Time: 24.96s
2025-07-17 18:39:51,554 - INFO - [Epoch 22/30] Train Loss: 0.7154 | Val Loss: 0.7314 | Time: 25.36s
2025-07-17 18:40:16,188 - INFO - [Epoch 23/30] Train Loss: 0.7127 | Val Loss: 0.6943 | Time: 24.63s
2025-07-17 18:40:41,042 - INFO - [Epoch 24/30] Train Loss: 0.6996 | Val Loss: 0.7126 | Time: 24.85s
2025-07-17 18:41:07,466 - INFO - [Epoch 25/30] Train Loss: 0.6966 | Val Loss: 0.7212 | Time: 26.42s
2025-07-17 18:41:32,723 - INFO - [Epoch 26/30] Train Loss: 0.7006 | Val Loss: 0.7415 | Time: 25.26s
2025-07-17 18:41:57,696 - INFO - [Epoch 27/30] Train Loss: 0.7249 | Val Loss: 0.7007 | Time: 24.97s
2025-07-17 18:42:22,663 - INFO - [Epoch 28/30] Train Loss: 0.6970 | Val Loss: 0.7144 | Time: 24.97s
2025-07-17 18:42:47,808 - INFO - [Epoch 29/30] Train Loss: 0.6728 | Val Loss: 0.6882 | Time: 25.14s
2025-07-17 18:43:12,623 - INFO - [Epoch 30/30] Train Loss: 0.7130 | Val Loss: 0.7123 | Time: 24.81s
2025-07-17 18:43:12,748 - INFO - Loss plot saved to plots/2025-07-17_hist_loss_plot.png
